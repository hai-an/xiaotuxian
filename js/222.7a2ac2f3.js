"use strict";(self["webpackChunkerabbit_pc_vue_project"]=self["webpackChunkerabbit_pc_vue_project"]||[]).push([[222],{1787:function(e,t,s){s.d(t,{IA:function(){return l},Kx:function(){return u},ZI:function(){return n},lK:function(){return c},t5:function(){return o},z6:function(){return r}});var a=s(4471);const l=e=>(0,a.Z)("/goods","get",{id:e}),n=(e,t=16)=>(0,a.Z)("/goods/relevant","get",{id:e,limit:t}),c=({id:e,type:t,limit:s=3})=>(0,a.Z)("/goods/hot","get",{id:e,type:t,limit:s}),o=e=>(0,a.Z)(`https://mock.boxuegu.com/mock/1175/goods/${e}/evaluate`),r=(e,t)=>(0,a.Z)(`https://mock.boxuegu.com/mock/1175/goods/${e}/evaluate/page`,"get",t),u=e=>(0,a.Z)(`/goods/sku/${e}`,"get")},5765:function(e,t,s){s.r(t),s.d(t,{default:function(){return De}});var a=s(3396),l=s(7139);const n=e=>((0,a.dD)("data-v-1ba77c84"),e=e(),(0,a.Cn)(),e),c={class:"xtx-cart-page"},o={class:"container"},r={class:"cart"},u={width:"120"},d=n((()=>(0,a._)("th",{width:"400"},"商品信息",-1))),i=n((()=>(0,a._)("th",{width:"220"},"单价",-1))),p=n((()=>(0,a._)("th",{width:"180"},"数量",-1))),g=n((()=>(0,a._)("th",{width:"180"},"小计",-1))),k=n((()=>(0,a._)("th",{width:"140"},"操作",-1))),h={key:0},_={colspan:"6"},v={class:"goods"},m=["src"],f={class:"name ellipsis"},w={class:"tc"},C={key:0},I={class:"red"},b={class:"tc"},y={class:"tc"},x={class:"f16 red"},D={class:"tc"},Z=n((()=>(0,a._)("p",null,[(0,a._)("a",{href:"javascript:;"},"移入收藏夹")],-1))),S=["onClick"],$=n((()=>(0,a._)("p",null,[(0,a._)("a",{href:"javascript:;"},"找相似")],-1))),z={key:0},j=n((()=>(0,a._)("tr",null,[(0,a._)("td",{colspan:"6"},[(0,a._)("h3",{class:"tit"},"失效商品")])],-1))),W={class:"goods"},H=["src"],P={class:"name ellipsis"},U={class:"attr"},A={class:"tc"},T={class:"tc"},V={class:"tc"},X={class:"tc"},q=["onClick"],E=n((()=>(0,a._)("p",null,[(0,a._)("a",{href:"javascript:;"},"找相似")],-1))),K={class:"action"},N={class:"batch"},G=n((()=>(0,a._)("a",{href:"javascript:;"},"移入收藏夹",-1))),B={class:"total"},L={class:"red"};function O(e,t,s,n,O,R){const Y=(0,a.up)("XtxBreadItem"),M=(0,a.up)("XtxBread"),F=(0,a.up)("XtxCheckbox"),J=(0,a.up)("CartNone"),Q=(0,a.up)("RouterLink"),ee=(0,a.up)("CartSku"),te=(0,a.up)("XtxNumbox"),se=(0,a.up)("XtxButton"),ae=(0,a.up)("GoodRelevant");return(0,a.wg)(),(0,a.iD)("div",c,[(0,a._)("div",o,[(0,a.Wm)(M,null,{default:(0,a.w5)((()=>[(0,a.Wm)(Y,{to:"/"},{default:(0,a.w5)((()=>[(0,a.Uk)("首页")])),_:1}),(0,a.Wm)(Y,null,{default:(0,a.w5)((()=>[(0,a.Uk)("购物车")])),_:1})])),_:1}),(0,a._)("div",r,[(0,a._)("table",null,[(0,a._)("thead",null,[(0,a._)("tr",null,[(0,a._)("th",u,[(0,a.Wm)(F,{onChange:n.checkAll,modelValue:e.$store.getters["cart/isCheckAll"]},{default:(0,a.w5)((()=>[(0,a.Uk)("全选")])),_:1},8,["onChange","modelValue"])]),d,i,p,g,k])]),(0,a._)("tbody",null,[0===e.$store.getters["cart/validList"].length?((0,a.wg)(),(0,a.iD)("tr",h,[(0,a._)("td",_,[(0,a.Wm)(J)])])):(0,a.kq)("",!0),((0,a.wg)(!0),(0,a.iD)(a.HY,null,(0,a.Ko)(e.$store.getters["cart/validList"],(e=>((0,a.wg)(),(0,a.iD)("tr",{key:e.skuId},[(0,a._)("td",null,[(0,a.Wm)(F,{onChange:t=>n.checkOne(e.skuId,t),modelValue:e.selected},null,8,["onChange","modelValue"])]),(0,a._)("td",null,[(0,a._)("div",v,[(0,a.Wm)(Q,{to:`/product/${e.id}`},{default:(0,a.w5)((()=>[(0,a._)("img",{src:e.picture,alt:""},null,8,m)])),_:2},1032,["to"]),(0,a._)("div",null,[(0,a._)("p",f,(0,l.zw)(e.name),1),(0,a.Wm)(ee,{onChange:t=>n.updateCartSku(e.skuId,t),skuId:e.skuId,"attrs-text":e.attrsText},null,8,["onChange","skuId","attrs-text"])])])]),(0,a._)("td",w,[(0,a._)("p",null,"¥"+(0,l.zw)(e.nowPrice),1),e.price-e.nowPrice>0?((0,a.wg)(),(0,a.iD)("p",C,[(0,a.Uk)("比加入时降价 "),(0,a._)("span",I,"¥"+(0,l.zw)(e.price-e.nowPrice),1)])):(0,a.kq)("",!0)]),(0,a._)("td",b,[(0,a.Wm)(te,{modelValue:e.count,max:e.stock,onChange:t=>n.changeCount(e.skuId,t)},null,8,["modelValue","max","onChange"])]),(0,a._)("td",y,[(0,a._)("p",x,"¥"+(0,l.zw)(100*e.nowPrice*e.count/100),1)]),(0,a._)("td",D,[Z,(0,a._)("p",null,[(0,a._)("a",{onClick:t=>n.deleteCart(e.skuId),class:"green",href:"javascript:;"},"删除",8,S)]),$])])))),128))]),e.$store.getters["cart/invalidList"].length>0?((0,a.wg)(),(0,a.iD)("tbody",z,[j,((0,a.wg)(!0),(0,a.iD)(a.HY,null,(0,a.Ko)(e.$store.getters["cart/invalidList"],(e=>((0,a.wg)(),(0,a.iD)("tr",{key:e.skuId},[(0,a._)("td",null,[(0,a.Wm)(F,{style:{color:"#eee"}})]),(0,a._)("td",null,[(0,a._)("div",W,[(0,a.Wm)(Q,{to:`/product/${e.id}`},{default:(0,a.w5)((()=>[(0,a._)("img",{src:e.picture,alt:""},null,8,H)])),_:2},1032,["to"]),(0,a._)("div",null,[(0,a._)("p",P,(0,l.zw)(e.name),1),(0,a._)("p",U,(0,l.zw)(e.attrsText),1)])])]),(0,a._)("td",A,[(0,a._)("p",null,"¥"+(0,l.zw)(e.nowPrice),1)]),(0,a._)("td",T,(0,l.zw)(e.count),1),(0,a._)("td",V,[(0,a._)("p",null,"¥"+(0,l.zw)(100*e.nowPrice*e.count/100),1)]),(0,a._)("td",X,[(0,a._)("p",null,[(0,a._)("a",{onClick:t=>n.deleteCart(e.skuId),class:"green",href:"javascript:;"},"删除",8,q)]),E])])))),128))])):(0,a.kq)("",!0)])]),(0,a._)("div",K,[(0,a._)("div",N,[(0,a.Wm)(F,{onChange:n.checkAll,modelValue:e.$store.getters["cart/isCheckAll"]},{default:(0,a.w5)((()=>[(0,a.Uk)("全选")])),_:1},8,["onChange","modelValue"]),(0,a._)("a",{onClick:t[0]||(t[0]=e=>n.batchDeleteCart()),href:"javascript:;"},"删除商品"),G,(0,a._)("a",{onClick:t[1]||(t[1]=e=>n.batchDeleteCart(!0)),href:"javascript:;"},"清空失效商品")]),(0,a._)("div",B,[(0,a.Uk)(" 共 "+(0,l.zw)(e.$store.getters["cart/validTotal"])+" 件商品，已选择 "+(0,l.zw)(e.$store.getters["cart/selectedTotal"])+" 件，商品合计： ",1),(0,a._)("span",L,"¥"+(0,l.zw)(e.$store.getters["cart/selectedAmount"].toFixed(2)),1),(0,a.Wm)(se,{onClick:n.checkOut,type:"primary"},{default:(0,a.w5)((()=>[(0,a.Uk)("下单结算")])),_:1},8,["onClick"])])]),(0,a.Wm)(ae)])])}s(7658);var R=s(7296),Y=s.p+"img/none.243beb2a.png";const M=e=>((0,a.dD)("data-v-2a071270"),e=e(),(0,a.Cn)(),e),F={class:"cart-none"},J=M((()=>(0,a._)("img",{src:Y,alt:""},null,-1))),Q=M((()=>(0,a._)("p",null,"购物车内暂时没有商品",-1))),ee={class:"btn"};function te(e,t,s,l,n,c){const o=(0,a.up)("XtxButton");return(0,a.wg)(),(0,a.iD)("div",F,[J,Q,(0,a._)("div",ee,[(0,a.Wm)(o,{type:"primary",onClick:t[0]||(t[0]=t=>e.$router.push("/"))},{default:(0,a.w5)((()=>[(0,a.Uk)("继续逛逛")])),_:1})])])}var se={name:"CartNone"},ae=s(89);const le=(0,ae.Z)(se,[["render",te],["__scopeId","data-v-2a071270"]]);var ne=le;const ce=e=>((0,a.dD)("data-v-adb8539a"),e=e(),(0,a.Cn)(),e),oe={class:"cart-sku",ref:"target"},re={class:"ellipsis"},ue=ce((()=>(0,a._)("i",{class:"iconfont icon-angle-down"},null,-1))),de={key:0,class:"layer"},ie={key:0,class:"loading"};function pe(e,t,s,n,c,o){const r=(0,a.up)("GoodsSku"),u=(0,a.up)("XtxButton");return(0,a.wg)(),(0,a.iD)("div",oe,[(0,a._)("div",{class:"attrs",onClick:t[0]||(t[0]=e=>n.toggle())},[(0,a._)("span",re,(0,l.zw)(s.attrsText),1),ue]),n.visable?((0,a.wg)(),(0,a.iD)("div",de,[n.goods?(0,a.kq)("",!0):((0,a.wg)(),(0,a.iD)("div",ie)),n.goods?((0,a.wg)(),(0,a.j4)(r,{key:1,onChange:n.changeSku,skuId:s.skuId,goods:n.goods},null,8,["onChange","skuId","goods"])):(0,a.kq)("",!0),n.goods?((0,a.wg)(),(0,a.j4)(u,{key:2,onClick:t[1]||(t[1]=e=>n.submit()),type:"primary",size:"mini",style:{"margin-left":"60px"}},{default:(0,a.w5)((()=>[(0,a.Uk)("确认")])),_:1})):(0,a.kq)("",!0)])):(0,a.kq)("",!0)],512)}var ge=s(4870),ke=s(903),he=s(8401),_e=s(1787),ve={name:"CartSku",props:{attrsText:{type:String,default:""},skuId:{type:String,default:""}},components:{GoodsSku:ke.Z},setup(e,{emit:t}){const s=(0,ge.iH)(!1),a=(0,ge.iH)(null),l=(0,ge.iH)(!1),n=(0,ge.iH)(null),c=e=>{n.value=e},o=()=>{n.value&&n.value.skuId&&n.value.skuId!==e.skuId&&(t("change",n.value),u())},r=()=>{s.value=!0,(0,_e.Kx)(e.skuId).then((e=>{a.value=e.result}))},u=()=>{s.value=!1,a.value=null},d=()=>{s.value?u():r(),console.log(123213)},i=(0,ge.iH)(null);return(0,he.i9)(i,(()=>{u()})),{target:i,open:r,close:u,toggle:d,visable:s,goods:a,loading:l,changeSku:c,submit:o}}};const me=(0,ae.Z)(ve,[["render",pe],["__scopeId","data-v-adb8539a"]]);var fe=me,we=s(65),Ce=s(8362),Ie=s(8391),be=s(2483),ye={name:"XtxCartPage",components:{GoodRelevant:R.Z,CartNone:ne,CartSku:fe},setup(){const e=(0,we.oR)(),t=(0,be.tv)(),s=(t,s)=>{e.dispatch("cart/updateCart",{skuId:t,selected:s})},a=t=>{e.dispatch("cart/checkAllCart",t)},l=t=>{console.log(t),(0,Ce.Z)({title:"友情提示",text:"亲,你确定要删除该商品吗?"}).then((()=>{e.dispatch("cart/deleteCart",t),(0,Ie.Z)({type:"success",text:"删除成功"})})).catch((e=>{}))},n=t=>{(0,Ce.Z)({title:"友情提示",text:`亲,你确定要删除${t?"失效":"选中"}的商品吗?`}).then((()=>{e.dispatch("cart/batchDeleteCart",t),(0,Ie.Z)({type:"success",text:"删除成功"})})).catch((e=>{}))},c=(t,s)=>{e.dispatch("cart/updateCart",{skuId:t,count:s})},o=(t,s)=>{e.dispatch("cart/updateCartSku",{oldSkuId:t,newSku:s})},r=()=>{if(0===e.getters["cart/selectedTotal"])return(0,Ie.Z)({text:"至少选中一件商品才能结算"});e.state.user.profile.token?t.push("/member/checkout"):(0,Ce.Z)({text:"登录后才能结算,点击确定登录!"}).then((()=>{t.push("/member/checkout")})).catch((e=>{}))};return{checkOne:s,checkAll:a,deleteCart:l,batchDeleteCart:n,changeCount:c,updateCartSku:o,checkOut:r}}};const xe=(0,ae.Z)(ye,[["render",O],["__scopeId","data-v-1ba77c84"]]);var De=xe},7296:function(e,t,s){s.d(t,{Z:function(){return v}});var a=s(3396),l=s(7139);const n=e=>((0,a.dD)("data-v-64a9ff65"),e=e(),(0,a.Cn)(),e),c={class:"goods-relevant"},o={class:"header"},r=n((()=>(0,a._)("i",{class:"icon"},null,-1))),u={class:"title"};function d(e,t,s,n,d,i){const p=(0,a.up)("xtx-carousel");return(0,a.wg)(),(0,a.iD)("div",c,[(0,a._)("div",o,[r,(0,a._)("span",u,(0,l.zw)(s.goodsId?"同类商品推荐":"猜你喜欢"),1)]),(0,a.Wm)(p,{sliders:n.sliders},null,8,["sliders"])])}s(7658);var i=s(1787),p=s(4870);const g=e=>{const t=(0,p.iH)([]);return(0,i.ZI)(e).then((e=>{const s=4,a=Math.ceil(e.result.length/s);for(let l=0;l<a;l++)t.value.push(e.result.slice(l*s,(l+1)*s));console.log(t)})),t};var k={name:"GoodsRelevant",props:{goodsId:{type:String,default:""}},setup(e){const t=g(e.goodsId);return{sliders:t}}},h=s(89);const _=(0,h.Z)(k,[["render",d],["__scopeId","data-v-64a9ff65"]]);var v=_},903:function(e,t,s){s.d(t,{Z:function(){return m}});var a=s(3396),l=s(7139);const n={class:"goods-sku"},c=["onClick","src","title"],o=["onClick"];function r(e,t,s,r,u,d){return(0,a.wg)(),(0,a.iD)("div",n,[((0,a.wg)(!0),(0,a.iD)(a.HY,null,(0,a.Ko)(s.goods.specs,(e=>((0,a.wg)(),(0,a.iD)("dl",{key:e.id},[(0,a._)("dt",null,(0,l.zw)(e.name),1),(0,a._)("dd",null,[((0,a.wg)(!0),(0,a.iD)(a.HY,null,(0,a.Ko)(e.values,(t=>((0,a.wg)(),(0,a.iD)(a.HY,{key:t.name},[t.picture?((0,a.wg)(),(0,a.iD)("img",{key:0,onClick:s=>r.clickSpecs(e,t),class:(0,l.C_)({selected:t.selected,disabled:t.disabled}),src:t.picture,title:t.name},null,10,c)):((0,a.wg)(),(0,a.iD)("span",{key:1,class:(0,l.C_)({selected:t.selected,disabled:t.disabled}),onClick:s=>r.clickSpecs(e,t)},(0,l.zw)(t.name),11,o))],64)))),128))])])))),128))])}s(7658);function u(e){const t=[],s=2**e.length;for(let a=0;a<s;a+=1){const s=[];for(let t=0;t<e.length;t+=1)a&1<<t&&s.push(e[t]);t.push(s)}return t}const d="★",i=e=>{const t={};return e.forEach((e=>{if(e.inventory>0){const s=e.specs.map((e=>e.valueName));console.log(s);const a=u(s);console.log(a),a.forEach((s=>{const a=s.join(d);t[a]?t[a].push(e.id):t[a]=[e.id]}))}})),console.log(t),t},p=e=>{const t=[];return e.forEach((e=>{const s=e.values.find((e=>e.selected));t.push(s?s.name:void 0)})),t},g=(e,t)=>{e.forEach(((s,a)=>{const l=p(e);s.values.forEach((e=>{if(e.name===l[a])return!1;l[a]=e.name;const s=l.filter((e=>e)).join(d);e.disabled=!t[s]}))}))},k=(e,t)=>{const s=e.skus.find((e=>e.id===t));e.specs.forEach(((e,t)=>{const a=e.values.find((e=>e.name===s.specs[t].valueName));a.selected=!0}))};var h={name:"GoodsSku",props:{goods:{type:Object,default:()=>({specs:[],skus:[]})},skuId:{type:String,default:""}},setup(e,{emit:t}){const s=i(e.goods.skus);e.skuId&&(console.log("props.skuId",e.skuId),k(e.goods,e.skuId)),g(e.goods.specs,s);const a=(a,l)=>{if(l.disabled)return!1;l.selected?l.selected=!1:(a.values.forEach((e=>{e.selected=!1})),l.selected=!0),g(e.goods.specs,s);const n=p(e.goods.specs).filter((e=>e));if(n.length===e.goods.specs.length){const a=s[n.join(d)],l=e.goods.skus.find((e=>e.id===a[0]));t("change",{skuId:l.id,price:l.price,oldPrice:l.oldPrice,inventory:l.inventory,specsText:l.specs.reduce(((e,t)=>`${e} ${t.name}: ${t.valueName}`),"").trim()})}else console.log("不完整"),t("change",{})};return{clickSpecs:a,pathMap:s}}},_=s(89);const v=(0,_.Z)(h,[["render",r],["__scopeId","data-v-82e9dd20"]]);var m=v}}]);
//# sourceMappingURL=222.7a2ac2f3.js.map